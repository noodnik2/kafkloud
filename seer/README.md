# `seer` - _one that sees_

Seer can tell you things you may not have realized about what's been
communicated in the set of messages sent to a specific topic in Kafkloud.

## Main Idea

Get on-board the AI craze and insert a GPT-like "seer" into the Kafkloud
data pipeline.

The main use case is to "teach" Seer things that it can later recall,
summarize and put into a greater "context" in response to questions
about what it's learned.

### How It Works

Seer receives its input messages on two `streamer` channels (Kafka topics),
and writes its output to another one:

- `seer-statements` - a stream of statements which `seer` "embeds" into its
  understanding of the world, and will use as context when answering questions 
- `seer-questions` - a stream of questions which `seer` will attempt to answer,
  taking into account the context provided in prior messages received
  from `seer-statements`
- `seer-answers` - an output stream of answers generated by `seer` in response
  to questions it's received on `seer-questions`

## Implementation

As of this writing, four Python modules comprise the implementation of `seer`:

1. [seer.py](app/seer.py) - exposes four APIs:
   - `accept` - accepts message(s) into `seer`'s context
   - `load` - accepts file(s) whose contents will be added to `seer`'s context
   - `ask` - accepts question(s) which `seer` will attempt to answer
2. [cli.py](app/cli.py) - Command Line Interface (CLI) exposing `seer`'s APIs
3. [fastapi.py](app/fastapi.py) - HTTP REST interface exposing `seer`'s API
4. [kafka.py](app/kafka.py) - Kafka (aka `streamer`) interface to `seer` as
   described above 

### Current State
As of this writing, `seer` implements a [Python module](app/seer.py)
for which there's a [CLI](app/cli.py) and [HTTP](app/fastapi.py) interface,
used now mainly for testing.  Its packaging includes standalone and Docker
deployments, and its Kubernetes deployment artifacts are partially implemented.
See the [Makefile](Makefile) for the related deployment targets.

### Future State
It's envisioned to add interface(s) to `seer` enabling it to respond to
incoming questions on a (Kafka) topic, and deliver answers to another.

### Which library to use?
After reading several comparisons of the available options, it appears we should start
out by trying the Confluent client: 
- [Notes on Kafka in Python](https://matthewrocklin.com/blog/work/2017/10/10/kafka-python)
- [Support for Scalability and Recovery](https://stackoverflow.com/questions/73049329/python-kafka-consumer-library-that-supports-scalability-and-recoverability)
- [Introduction to Confluent Kafka Python Producer](https://www.geeksforgeeks.org/introduction-to-confluent-kafka-python-producer/)
- [Python Kafka Client Benchmarking](http://activisiongamescience.github.io/2016/06/15/Kafka-Client-Benchmarking/)

## Dialogues

### Using the CLI
```shell
$ python app/cli.py -v -q "Do you know anything about the Wilymajinkas?"
using chromadb(localhost:8000)
received questions(['Do you know anything about the Wilymajinkas?'])
running query: Do you know anything about the Wilymajinkas?
the answer is:  No, I don not know anything about the Wilymajinkas.
$ python app/cli.py -v -a "The Wilymajinkas are a tribe of northeastern Native Americans."  -a "They are very tame and should not be feared."
using chromadb(localhost:8000)
received texts(['The Wilymajinkas are a tribe of northeastern Native Americans.', 'They are very tame and should not be feared.'])
RecursiveCharacterTextSplitter
text_splitter.split_documents
Chroma.from_documents
$ python app/cli.py -v -q "Do you know anything about the Wilymajinkas?"
using chromadb(localhost:8000)
received questions(['Do you know anything about the Wilymajinkas?'])
running query: Do you know anything about the Wilymajinkas?
the answer is:  Yes, the Wilymajinkas are a tribe of northeastern Native Americans. They are very tame and should not be feared.
```

### Using HTTP

- [Seer Tests](./tests/seer_tests.http)